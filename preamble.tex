%\documentclass{tuftebook}
\usepackage{graphicx}
\usepackage[export]{adjustbox}
\usepackage{amsthm}
\usepackage[many]{tcolorbox}
\usepackage[margin=0.75in]{geometry}
\usepackage{amsfonts}
\usepackage{mathtools}
\usepackage{enumerate}
\usepackage{wrapfig}
\usepackage[makeroom]{cancel}

\makeatletter

\makeatletter

\def\renewtheorem#1{%
	\expandafter\let\csname#1\endcsname\relax
	\expandafter\let\csname c@#1\endcsname\relax
	\gdef\renewtheorem@envname{#1}
	\renewtheorem@secpar
}
\def\renewtheorem@secpar{\@ifnextchar[{\renewtheorem@numberedlike}{\renewtheorem@nonumberedlike}}
\def\renewtheorem@numberedlike[#1]#2{\newtheorem{\renewtheorem@envname}[#1]{#2}}
\def\renewtheorem@nonumberedlike#1{
	\def\renewtheorem@caption{#1}
	\edef\renewtheorem@nowithin{\noexpand\newtheorem{\renewtheorem@envname}{\renewtheorem@caption}}
	\renewtheorem@thirdpar
}
\def\renewtheorem@thirdpar{\@ifnextchar[{\renewtheorem@within}{\renewtheorem@nowithin}}
\def\renewtheorem@within[#1]{\renewtheorem@nowithin[#1]}

\makeatother

%%%%%%%%%%%%%%%%%%%%
% New environments %
%%%%%%%%%%%%%%%%%%%%

\makeatother
%\mdfsetup{skipabove=1em,skipbelow=0em}

\tcbuselibrary{skins}

% Color definitions

\definecolor{proofcolor}{RGB}{0,0,0}

% Dark orange and Dark Red rgb
%\definecolor{theorembordercolor}{RGB}{151, 63, 5}
%\definecolor{theorembackgroundcolor}{RGB}{248, 241, 234}
\definecolor{theorembordercolor}{RGB}{255, 165, 0}
\definecolor{theorembackgroundcolor}{RGB}{254, 249, 243}

%\definecolor{examplebordercolor}{RGB}{0, 110, 184}
\definecolor{remarkbackgroundcolor}{RGB}{240, 244, 250}

\definecolor{examplebordercolor}{RGB}{199, 0, 57}
\definecolor{examplebackgroundcolor}{RGB}{248, 241, 234}

\definecolor{remarkbordercolor}{RGB}{0, 110, 184}

\definecolor{definitionbordercolor}{RGB}{0, 150, 85}
\definecolor{definitionbackgroundcolor}{RGB}{239, 247, 243}

\definecolor{propertybordercolor}{RGB}{128, 0, 128}
\definecolor{propertybackgroundcolor}{RGB}{255, 240, 255}

\definecolor{formulabordercolor}{RGB}{0, 0, 0}
\definecolor{formulabackgroundcolor}{RGB}{230, 229, 245}

\newtheoremstyle{theorem}
{0pt}{0pt}{\normalfont}{0pt}
{}{\;}{0.25em}
{{\sffamily\bfseries\color{theorembordercolor}\thmname{#1}~\thmnumber{\textup{#2}}.}
	\thmnote{\normalfont\color{black}~(#3)}}

\newtheoremstyle{definition}
{0pt}{0pt}{\normalfont}{0pt}
{}{\;}{0.25em}
{{\sffamily\bfseries\color{definitionbordercolor}\thmname{#1}~\thmnumber{\textup{#2}}.}
	\thmnote{\normalfont\color{black}~(#3)}}

\newtheoremstyle{notation}
{0pt}{0pt}{\normalfont}{0pt}
{}{\;}{0.25em}
{{\sffamily\bfseries\color{definitionbordercolor}\thmname{#1}~\thmnumber{\textup{#2}}.}
	\thmnote{\normalfont\color{black}~(#3)}}

\newtheoremstyle{example}
{0pt}{0pt}{\normalfont}{0pt}
{}{\;}{0.25em}
{{\sffamily\bfseries\color{examplebordercolor}\thmname{#1}~\thmnumber{\textup{#2}}.}
	\thmnote{\normalfont\color{black}~(#3)}}
	
\newtheoremstyle{remark}
{0pt}{0pt}{\normalfont}{0pt}
{}{\;}{0.25em}
{{\sffamily\bfseries\color{remarkbordercolor}\thmname{#1}.}
	\thmnote{\normalfont\color{black}~(#3)}}	

\newtheoremstyle{property}
{0pt}{0pt}{\normalfont}{0pt}
{}{\;}{0.25em}
{{\sffamily\bfseries\color{propertybordercolor}\thmname{#1}~\thmnumber{\textup{#2}}.}
	\thmnote{\normalfont\color{black}~(#3)}}

\newtheoremstyle{formula}
{0pt}{0pt}{\normalfont}{0pt}
{}{\;}{0.25em}
{{\sffamily\bfseries\color{formulabordercolor}\thmname{#1}~\thmnumber{\textup{#2}}.}
	\thmnote{\normalfont\color{black}~(#3)}}

%%%%%%%%%%%%%%%%%%%%%%%%
% Theorem Environments %
%%%%%%%%%%%%%%%%%%%%%%%%

\theoremstyle{theorem}

\newtheorem{theorem}{Theorem}
\newtheorem{contrapositive}{Contrapositive}
\numberwithin{theorem}{section}
\numberwithin{contrapositive}{section}
\newtheorem{postulate}{Postulate}
\newtheorem{conjecture}{Conjecture}
%\newtheorem{corollary}{Corollary}
%\newtheorem{lemma}{Lemma}
\newtheorem{conclusion}{Conclusion}

\tcolorboxenvironment{theorem}{
	enhanced jigsaw, pad at break*=1mm, breakable,
	left=4mm, right=4mm, top=1mm, bottom=1mm,
	colback=theorembackgroundcolor, boxrule=0pt, frame hidden,
	borderline west={0.5mm}{0mm}{theorembordercolor}, arc=.5mm
}
\tcolorboxenvironment{contrapositive}{
	enhanced jigsaw, pad at break*=1mm, breakable,
	left=4mm, right=4mm, top=1mm, bottom=1mm,
	colback=theorembackgroundcolor, boxrule=0pt, frame hidden,
	borderline west={0.5mm}{0mm}{theorembordercolor}, arc=.5mm
}
\tcolorboxenvironment{postulate}{
	enhanced jigsaw, pad at break*=1mm, breakable,
	left=4mm, right=4mm, top=1mm, bottom=1mm,
	colback=theorembackgroundcolor, boxrule=0pt, frame hidden,
	borderline west={0.5mm}{0mm}{theorembordercolor}, arc=.5mm
}
\tcolorboxenvironment{conjecture}{
	enhanced jigsaw, pad at break*=1mm, breakable,
	left=4mm, right=4mm, top=1mm, bottom=1mm,
	colback=theorembackgroundcolor, boxrule=0pt, frame hidden,
	borderline west={0.5mm}{0mm}{theorembordercolor}, arc=.5mm
}
%\tcolorboxenvironment{corollary}{
%	enhanced jigsaw, pad at break*=1mm, breakable,
%	left=4mm, right=4mm, top=1mm, bottom=1mm,
%	colback=theorembackgroundcolor, boxrule=0pt, frame hidden,
%	borderline west={0.5mm}{0mm}{theorembordercolor}, arc=.5mm
%}
%\tcolorboxenvironment{lemma}{
%	enhanced jigsaw, pad at break*=1mm, breakable,
%	left=4mm, right=4mm, top=1mm, bottom=1mm,
%	colback=theorembackgroundcolor, boxrule=0pt, frame hidden,
%	borderline west={0.5mm}{0mm}{theorembordercolor}, arc=.5mm
%}
\tcolorboxenvironment{conclusion}{
	enhanced jigsaw, pad at break*=1mm, breakable,
	left=4mm, right=4mm, top=1mm, bottom=1mm,
	colback=theorembackgroundcolor, boxrule=0pt, frame hidden,
	borderline west={0.5mm}{0mm}{theorembordercolor}, arc=.5mm
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Definition Environments %
%%%%%%%%%%%%%%%%%%%%%%%%%%%

\theoremstyle{definition}
\newtheorem{definition}{Definition}
\numberwithin{definition}{section}
\newtheorem{review}{Review}
\newtheorem*{notation}{Notation}
\tcolorboxenvironment{notation}{
	enhanced jigsaw, pad at break*=1mm, breakable,
	left=4mm, right=4mm, top=1mm, bottom=1mm,
	colback=white, boxrule=0pt, frame hidden,
	borderline west={0.5mm}{0mm}{definitionbordercolor},
	borderline east={0.5mm}{0mm}{definitionbordercolor},
	borderline north={0.5mm}{0mm}{definitionbordercolor},
	borderline south={0.5mm}{0mm}{definitionbordercolor},
	 arc=.5mm
}

\tcolorboxenvironment{definition}{
	enhanced jigsaw, pad at break*=1mm, breakable,
	left=4mm, right=4mm, top=1mm, bottom=1mm,
	colback=definitionbackgroundcolor, boxrule=0pt, frame hidden,
	borderline west={0.5mm}{0mm}{definitionbordercolor}, arc=.5mm
}
\tcolorboxenvironment{review}{
	enhanced jigsaw, pad at break*=1mm, breakable,
	left=4mm, right=4mm, top=1mm, bottom=1mm,
	colback=definitionbackgroundcolor, boxrule=0pt, frame hidden,
	borderline west={0.5mm}{0mm}{definitionbordercolor}, arc=.5mm
}


%%%%%%%%%%%%%%%%%%%%%%%%
% Example Environments %
%%%%%%%%%%%%%%%%%%%%%%%%

\theoremstyle{example}
\newtheorem{example}{Example}
\numberwithin{example}{section}
%\newtheorem*{remark}{Remark}
%\newtheorem*{note}{Note}

\tcolorboxenvironment{example}{
	enhanced jigsaw, pad at break*=1mm, breakable,
	left=4mm, right=4mm, top=1mm, bottom=1mm,
	colback=examplebackgroundcolor, boxrule=0pt, frame hidden,
	borderline west={0.5mm}{0mm}{examplebordercolor}, arc=.5mm
}

\theoremstyle{remark}
\newtheorem{remark}{Remark}
\newtheorem*{note}{Note}
\newtheorem*{recall}{Recall}
\newtheorem{observation}{Observation}
\newtheorem{fact}{Fact}
\tcolorboxenvironment{remark}{
	enhanced jigsaw, pad at break*=1mm, breakable,
	left=4mm, right=4mm, top=1mm, bottom=1mm,
	colback=white, boxrule=0pt, frame hidden,
	borderline west={0.5mm}{0mm}{remarkbordercolor},
	borderline east={0.5mm}{0mm}{remarkbordercolor},
	borderline north={0.5mm}{0mm}{remarkbordercolor},
	borderline south={0.5mm}{0mm}{remarkbordercolor},
	 arc=.5mm
}
\tcolorboxenvironment{note}{
	enhanced jigsaw, pad at break*=1mm, breakable,
	left=4mm, right=4mm, top=1mm, bottom=1mm,
	colback=white, boxrule=0pt, frame hidden,
	borderline west={0.5mm}{0mm}{remarkbordercolor},
	borderline east={0.5mm}{0mm}{remarkbordercolor},
	borderline north={0.5mm}{0mm}{remarkbordercolor},
	borderline south={0.5mm}{0mm}{remarkbordercolor}, arc=.5mm
}
\tcolorboxenvironment{recall}{
	enhanced jigsaw, pad at break*=1mm, breakable,
	left=4mm, right=4mm, top=1mm, bottom=1mm,
	colback=white, boxrule=0pt, frame hidden,
	borderline west={0.5mm}{0mm}{remarkbordercolor},
	borderline east={0.5mm}{0mm}{remarkbordercolor},
	borderline north={0.5mm}{0mm}{remarkbordercolor},
	borderline south={0.5mm}{0mm}{remarkbordercolor},
	 arc=.5mm
}
\tcolorboxenvironment{observation}{
	enhanced jigsaw, pad at break*=1mm, breakable,
	left=4mm, right=4mm, top=1mm, bottom=1mm,
	colback=remarkbackgroundcolor, boxrule=0pt, frame hidden,
	borderline west={0.5mm}{0mm}{remarkbordercolor}, arc=.5mm
}

\tcolorboxenvironment{fact}{
	enhanced jigsaw, pad at break*=1mm, breakable,
	left=4mm, right=4mm, top=1mm, bottom=1mm,
	colback=remarkbackgroundcolor, boxrule=0pt, frame hidden,
	borderline west={0.5mm}{0mm}{remarkbordercolor}, arc=.5mm
}

%%%%%%%%%%%%%%%%%%%%%%%%%
% Property Environments %
%%%%%%%%%%%%%%%%%%%%%%%%%

\theoremstyle{property}
\newtheorem{property}{Property}
\numberwithin{property}{section}
\newtheorem{proposition}{Proposition}
\newtheorem{corollary}{Corollary}
\numberwithin{corollary}{section}
\newtheorem{lemma}{Lemma}
\numberwithin{lemma}{section}

\tcolorboxenvironment{property}{
	enhanced jigsaw, pad at break*=1mm, breakable,
	left=4mm, right=4mm, top=1mm, bottom=1mm,
	colback=propertybackgroundcolor, boxrule=0pt, frame hidden,
	borderline west={0.5mm}{0mm}{propertybordercolor}, arc=.5mm
}
\tcolorboxenvironment{proposition}{
	enhanced jigsaw, pad at break*=1mm, breakable,
	left=4mm, right=4mm, top=1mm, bottom=1mm,
	colback=propertybackgroundcolor, boxrule=0pt, frame hidden,
	borderline west={0.5mm}{0mm}{propertybordercolor}, arc=.5mm
}
\tcolorboxenvironment{corollary}{
	enhanced jigsaw, pad at break*=1mm, breakable,
	left=4mm, right=4mm, top=1mm, bottom=1mm,
	colback=propertybackgroundcolor, boxrule=0pt, frame hidden,
	borderline west={0.5mm}{0mm}{propertybordercolor}, arc=.5mm
}
\tcolorboxenvironment{lemma}{
	enhanced jigsaw, pad at break*=1mm, breakable,
	left=4mm, right=4mm, top=1mm, bottom=1mm,
	colback=propertybackgroundcolor, boxrule=0pt, frame hidden,
	borderline west={0.5mm}{0mm}{propertybordercolor}, arc=.5mm
}

%%%%%%%%%%%%
% Formula %
%%%%%%%%%%%%

\theoremstyle{formula}
\newtheorem{formula}{Formula}

\tcolorboxenvironment{formula}{
	enhanced jigsaw, pad at break*=1mm, breakable,
	left=4mm, right=4mm, top=1mm, bottom=1mm,
	colback=formulabackgroundcolor, boxrule=0pt, frame hidden,
	borderline west={0.5mm}{0mm}{formulabordercolor}, arc=.5mm
}

%%%%%%%%%
% Proof %
%%%%%%%%%

% These patches must be placed after \tcolorboxenvironment !
\AddToHook{env/theorem/after}{\colorlet{proofcolor}{theorembordercolor}}
\AddToHook{env/postulate/after}{\colorlet{proofcolor}{propertybordercolor}}
\AddToHook{env/conjecture/after}{\colorlet{proofcolor}{remarkbordercolor}}
\AddToHook{env/corollary/after}{\colorlet{proofcolor}{propertybordercolor}}
\AddToHook{env/lemma/after}{\colorlet{proofcolor}{propertybordercolor}}
\AddToHook{env/conclusion/after}{\colorlet{proofcolor}{theorembordercolor}}

\AddToHook{env/definition/after}{\colorlet{proofcolor}{definitionbordercolor}}
\AddToHook{env/review/after}{\colorlet{proofcolor}{definitionbordercolor}}

\AddToHook{env/example/after}{\colorlet{proofcolor}{examplebordercolor}}
\AddToHook{env/remark/after}{\colorlet{proofcolor}{remarkbordercolor}}
\AddToHook{env/note/after}{\colorlet{proofcolor}{remarkbordercolor}}

\AddToHook{env/property/after}{\colorlet{proofcolor}{propertybordercolor}}
\AddToHook{env/proposition/after}{\colorlet{proofcolor}{propertybordercolor}}

\AddToHook{env/formula/after}{\colorlet{proofcolor}{formulabordercolor}}

\AddToHook{env/observation/after}{\colorlet{proofcolor}{remarkbordercolor}}

\renewcommand{\qedsymbol}{$\square$}
\let\qedsymbolMyOriginal\qedsymbol
\renewcommand{\qedsymbol}{
	\color{proofcolor}\qedsymbolMyOriginal
}

\newtheoremstyle{proof}
{0pt}{0pt}{\normalfont}{0pt}
{}{\;}{0.25em}
{{\sffamily\bfseries\color{proofcolor}\thmname{#1}.}
	\thmnote{\normalfont\color{black}~(\textit{#3})}}

\theoremstyle{proof}
\renewtheorem{proof}{Proof}

\tcolorboxenvironment{proof}{
	enhanced jigsaw, pad at break*=1mm, breakable,
	left=4mm, right=4mm, top=1mm, bottom=1mm,
	colback=white, boxrule=0pt, frame hidden,
	borderline west={0.5mm}{0mm}{proofcolor}, arc=.5mm
}

\newenvironment{info}{\begin{tcolorbox}[
		arc=0mm,
		colback=white,
		colframe=examplebordercolor,
		title=Informal Discussion,
		fonttitle=\sffamily,
		breakable
		]}{\end{tcolorbox}}
\newenvironment{terminology}{\begin{tcolorbox}[
		arc=0mm,
		colback=white,
		colframe=green!60!black,
		title=Terminology,
		fonttitle=\sffamily,
		breakable
		]}{\end{tcolorbox}}
\newenvironment{warning}{\begin{tcolorbox}[
		arc=0mm,
		colback=white,
		colframe=red,
		title=Warning,
		fonttitle=\sffamily,
		breakable
		]}{\end{tcolorbox}}
\newenvironment{caution}{\begin{tcolorbox}[
		arc=0mm,
		colback=white,
		colframe=yellow,
		title=Caution,
		fonttitle=\sffamily,
		breakable
		]}{\end{tcolorbox}}
	

%%%%%%%%%%%%%%%%%%%%%%%%
%% Analysis Commands
%%%%%%%%%%%%%%%%%%%%%%%%

% Topology
\newcommand{\closure}[1]{
	\overline{#1}
}

% Open Cover
\newcommand{\ocover}[1]{
	\{#1_\alpha \}_{\alpha \in \Lambda}
}
\newcommand{\unioncollect}[1]{
	\bigcup \limits_{\alpha \in \Lambda} #1 _\alpha
}
\newcommand{\st}{
	\text{ such that }
}

\newcommand{\routineMS} {
	\text{Let $(X,d)$ be a metric space}
}

\newcommand{\routineCompact}{
	\text{$K \subseteq X$ be compact}
}

\newcommand{\routineNS}{
	\text{Let $\left(X, \| \cdot \|\right)$ be a normed space}
}

\newcommand{\nbhd}[2] {
	N_{#1}(#2)
}
\newcommand{\nbhds}[3]{
	N_{#1}^{#2}(#3)
}

\newcommand{\F}{\mathbb{F}}
\newcommand{\R}{\mathbb{R}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\Q}{\mathbb{Q}}

\newcommand{\varrow}[1]{\overrightarrow{#1}}

% Sequences
\newcommand{\routineSeq}{
	Let $(X,d)$ be a metric space and let $(x_n)$ be a sequence in $X$.
}
\newcommand{\seq}[1]{
	$(#1 _n)$
}
\newcommand{\subseq}[1]{
	$(#1 _{n_k})$
}

\newcommand{\diam}[1]{
	\{d(a,b): a,b \in #1 \}
}

\newcommand{\Rbar}{
	\overline{\R}
}

% Derivatives
\newcommand{\ddx}[2]{
	\frac{d#1}{dx}(#2)
}
\newcommand{\slope}[4]{
	\frac{#1 - #2}{#3 - #4}
}
\newcommand{\lims}[2]{
	\lim \limits_{#1 \to #2}
}
\newcommand{\deriv}[2]{
	\lim \limits_{x \to c} \frac{#1(x) - #1(#2)}{x-#2}
}
\newcommand{\diffquot}[2]{
	\lim \limits_{h \to 0} \frac{#1(#2 + h) - #1(#2)}{h}
}
\newcommand{\contin}[2]{
	\forall \epsilon > 0 ~\exists \delta > 0 \st \text{if $|x-#2| < \delta$ then $|#1(x) - #1(#2)|< \epsilon$}
}
\newcommand{\limfunc}[2]{
	\forall \epsilon > 0 ~\exists \delta > 0 \st \text{if $0 < |x-#2| <\delta$ then $\left|#1 - #2\right| < \epsilon$}
}